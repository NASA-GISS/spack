# Set up Spack and Modules
export EHOME=/home/eafisch2
export SPACK_ROOT=$EHOME/spack7
#source $SPACK_ROOT/share/spack/setup-env.sh
export MODULEPATH=$MODULEPATH:$EHOME/spack7/share/spack/modules/linux-suse_linux11-x86_64
export PATH=$PATH:/home/eafisch2/spack7/bin

# http://stackoverflow.com/questions/59895/can-a-bash-script-tell-which-directory-it-is-stored-in
export SPACK_ENV_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
export SPACK_ENV=${SPACK_ENV_DIR##*/}    # Name of currently loaded Spack environment

# Load the main environment
module purge

module load comp/intel-18.0.5.274   # Actually v18.0.4
module load other/comp/gcc-5.3-sp3   # Used by intel
module load mpi/impi-18.0.5.274

# Bootstrap with Spack-built replacements of system tools
source /gpfsm/dnb53/eafisch2/spack7/var/spack/environments/tools-discover/loads

# Load Spack-generated modules
source $SPACK_ENV_DIR/loads

# Clear out Spack-set LD_LIBRARY_PATH
#export LD_LIBRARY_PATH=/usr/local/other/SLES11.3/openmpi/1.10.1/gcc-5.3/lib:/usr/local/other/SLES11.3/gcc/5.3.0/lib64

# Use open source code for a few of the modules
export PATH=$SPACK_ENV_DIR/git/modele-control/bin:$SPACK_ENV_DIR/git/pygiss/main:$PATH
export PYTHONPATH=$SPACK_ENV_DIR/git/modele-control/lib:$SPACK_ENV_DIR/git/pygiss:$PYTHONPATH

# Use system Python2 for Spack
#alias spack='PYTHONPATH= spack'
